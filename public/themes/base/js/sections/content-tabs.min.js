/**
 * Admui-iframe v2.1.0 (http://www.admui.com/)
 * Copyright 2015-2019 Admui Team
 * Licensed under the Admui License 1.1 (http://www.admui.com/about/license)
 */
!function(o,e,m){var g,d,f,i,p=m.configs.get("tabSittings"),w=function(t,e){var i=m.sessionStorage.get(p);switch(i=i||{},arguments.length){case 1:_.isObject(t)?m.extend(!0,i,t):delete i[t];break;case 2:i[t]=e}m.sessionStorage.set(p,i)},T=function(t,e){var i=t.find("a"),a=i.attr("target"),n=m.trim(i.attr("title")),s=e?e.url:i.attr("href"),r=g.find('> iframe[name="'+a+'"]');if(e&&"history"===e.type||o.history.pushState({name:n,url:s},"","#!"+s),m.site.contentTabs.enable(t),g.find("> .active").removeClass("active"),r.addClass("active"),w("checked",a),r.attr("src")){if(i.attr("href")!==s)return void m.site.contentTabs.reloadTab(s);m("title",o.top.document).text(m("title",m.contentFrame.document()).text())}else r.attr("src",s),m.site.frameEvents(r)};o.addEventListener("popstate",function(){var t=o.history.state;null===t&&(t=i),m.extend(t,{type:"history"}),m.site.contentTabs.buildTab(t)},!1),m.site.contentTabs={relative:0,tabTimeout:30,init:function(){var t,e;g=m("#admui-pageContent"),d=m("#admui-siteConTabs"),f=m("#admui-navTabs .site-menu"),this.bind(),e=m.sessionStorage.get(p),_.isNull(e)&&(t=d.find("li:first > a"),i={name:m.trim(t.attr("title")),url:m.trim(t.attr("href"))},e=m.extend(!0,{},{"frame-0":i,checked:t.attr("target"),tabId:0}),w(e))},bind:function(){var a=this,i=d.find("ul.con-tabs");this.tabWidth=i.find("li").width(),this.view=d.find(".contabs-scroll").width(),this.ifameTabs(),d.on("click.site.contabs","#admui-tabL",function(){a.tabPosition(i,a.tabWidth,"right")}).on("click.site.contabs","#admui-tabR",function(){var t=i.width();a.tabPosition(i,a.tabWidth,"left",a.view,t)}).on("click.site.contabs","ul.con-tabs>li",function(t){var e=m(t.target),i=m(this);return e.is("i.wb-close-mini")?a.closeTab(i.find("a").attr("href")):i.is(".active")||(i.siblings("li").removeClass("active"),i.addClass("active"),T(i)),!1}),d.on("click.site.contabs",".reload-page",function(){a.reloadTab()}).on("click.site.contabs",".close-other",function(){d.find("ul.con-tabs>li").each(function(){var t,e=m(this);e.is(".active")||0===e.index()||(t=e.find("a").attr("target"),e.remove(),g.children('[name="'+t+'"]').remove(),w(t))}),i.animate({left:0},100),a.btnView("hide")}).on("click.site.contabs",".close-all",function(){var t=d.find("ul.con-tabs>li"),e=t.eq(0);t.each(function(){var t,e=m(this);0!==e.index()&&(t=e.find("a").attr("target"),e.remove(),w(t))}),i.animate({left:0},100),a.btnView("hide"),e.addClass("active"),T(e),g.children(":not(:first)").remove(),a.tabSize()}),m(o).on("resize",this.resize)},ifameTabs:function(t){var c=this,l=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;m(t||e).on("click","a",function(t){var e,i,a,n,s=m(this),r=m.trim(s.attr("href"));if(""!==r){if(/^(#|javascript)/i.test(r)||l.test(r)&&!s.data("frame")||!1===s.data("frame"))return;if(e={name:m.trim(s.attr("title")||s.data("title")||s.text()||"加载中..."),url:r},"_blank"!==s.attr("target"))return n=(i=m.sessionStorage.get(p))[a=i.checked],d.find("li.active>a").attr("title",e.name).find(">span").text(e.name),g.find("iframe.active").attr("src",r),m.site.frameEvents(g.find("> iframe.active")),void w(a,m.extend(n,e));o.history.pushState(e,"","#!"+r),c.buildTab(e),0===f.find(s).length&&c.enable(s.parent())}t.preventDefault()})},enable:function(t){var e,i,a,n=m.trim(t.find("a").attr("href")),s=n.indexOf("#"),r=0<s?n.substring(0,s):n,c=f.find('a[href="'+r+'"]'),l=function(t){0<t.length&&(t.trigger("open.site.menu"),l(t.parent().closest("li.has-sub")))};0!==c.length||(a=!1,f.find("a").each(function(){var i=m(this),t=i.data("router");void 0!==t&&m.each(t.split(","),function(t,e){e===r&&(c=i,a=!0)})}),a)?(i=m.trim(c.closest(".tab-pane").attr("id")),m.trim(f.closest(".tab-pane.active").attr("id"))!==i&&m('#admui-navMenu a[href="#'+i+'"]').tab("show"),e=f.find("li.open"),f.find("li.active").trigger("deactive.site.menu"),c.closest("li").trigger("active.site.menu"),c.closest("li.has-sub").hasClass("open")||(0<e.length&&e.not(c.parents("li.has-sub")).trigger("close.site.menu"),l(c.closest("li.has-sub")))):m.site.menu.refresh()},resize:function(){var i,a,n,s,t=m.site.contentTabs,e=d.find("ul.con-tabs");i=function(){t.view=d.find(".contabs-scroll").width(),t.tabEvent(e,"media")},a=200,s=!0,function(){var t=arguments,e=this;s&&(i.apply(e,t),s=!1),n||(n=setTimeout(function(){clearTimeout(n),n=null,i.apply(e,t)},a||500))}()},buildTab:function(t,e){var i,a,n,s,r,c,l,o,d,f,u=m(".con-tabs"),h="",v={},b="";(function(t,e){var i,a,n,s,r=m.site.contentTabs,c=r.view,l=r.tabWidth,o=e.url,d=o.indexOf("?"),f=0<d?o.substring(0,d):"",u=t.find("a[href='"+o+"']").closest("li");if(0===u.length){if(""!==f&&(u=t.find("a[data-url='"+f+"']").closest("li")),0===u.length)return!1;if(u.hasClass("active"))return m.site.contentTabs.reloadTab(o),!0}if(u.hasClass("active"))return!0;if(t.find("li.active").removeClass("active"),u.addClass("active"),T(u,e),i=t.position().left,s=t.width(),a=u.prevAll("li").length*l,n=u.nextAll("li").length*l,-a<i){if(a+i<c)return!0;i=-(a-c+l)}else{if(-i<s-n)return!0;i=-(s-n-l)}return t.animate({left:i},100),!0})(u,t)||(a=t.name,c=0<(r=(s=t.url).indexOf("?"))?s.substring(0,r):"",_.isUndefined(e)||"on"===e?(n=m.sessionStorage.get(p).tabId,h="active",(v={checked:i="frame-"+(n+=1),tabId:n})[i]={url:b=s,name:t.name},w(v),u.find("li.active").removeClass("active")):"off"===e&&(i=t.index),u.append('<li class="'+h+'"><a href="'+s+'" data-url="'+c+'" target="'+i+'" title="'+a+'" rel="contents"><span>'+a+'</span><i class="icon wb-close-mini"></i></a></li>'),o=(l={name:i,url:b}).name,d=l.url,f=""===d?"":" active",d&&g.children(".active").removeClass("active"),g.append('<iframe src="'+d+'" frameborder="0" name="'+o+'" class="page-frame animation-fade'+f+'"></iframe>'),d&&m.site.frameEvents(g.find("iframe.active")),this.tabSize(),this.tabEvent(u,"media"))},tabSize:function(){var t,e=m(".con-tabs"),i=e.find("li").length;t=this.tabWidth*i,e.css("width",t)},tabEvent:function(t,e){var i=m(".con-tabs").width(),a=this.view,n=this.tabWidth;i>this.view?(this.tabPosition(t,n,"left",a,i,e),this.btnView("visible")):this.btnView("hide"),(this.currentView<a||this.currentContent>i)&&this.tabPosition(t,n,"right",a,i,e),this.currentView=this.view,this.currentContent=i},tabPosition:function(t,e,i,a,n,s){var r,c=this,l=t.position().left;if("left"===i){if(l<=a-n)return;void 0!==s?l=a-n:(l=0!==this.relative?l-e+this.relative:l-e,this.relative=0)}else if("right"===i){if(0===l)return;l=void 0!==s?n<=a?0:a-n:0<(r=l+e)+e?(c.relative=r,0):r}t.animate({left:l},100)},closeTab:function(t){var e=d.find("ul.con-tabs"),i=_.isUndefined(t)?e.find(">li.active"):e.find('a[href="'+t+'"]').parent(),a=i.children("a").attr("target"),n="",s=i.next("li");i.is(".active")&&((n=0<s.length?s:i.prev("li")).addClass("active"),T(n)),i.remove(),g.children('[name="'+a+'"]').remove(),w(a),this.tabSize(),this.tabEvent(m(".con-tabs"),"media")},reloadTab:function(t){var e=m.sessionStorage.get(p),i=e.checked,a=e[i],n=t||d.find("ul.con-tabs>li.active>a").attr("href");g.find("iframe.active").attr("src",n),m.site.frameEvents(g.find("> iframe.active")),a.url=n,w(i,a)},btnView:function(t){var e=m("#admui-tabL"),i=m("#admui-tabR");"visible"===t?(e.removeClass("hide"),i.removeClass("hide")):"hide"===t&&(e.addClass("hide"),i.addClass("hide"))}}}(window,document,jQuery);