/**
 * Admui-iframe v2.1.0 (http://www.admui.com/)
 * Copyright 2015-2019 Admui Team
 * Licensed under the Admui License 1.1 (http://www.admui.com/about/license)
 */
!function(a,i,s){"use strict";i.App.extend({handleAction:function(){var e=s(".site-action").actionBtn().data("actionBtn"),t=s("[data-selectable]"),n=s("#addMailForm");s(a).on("click",".site-action-toggle",".site-action",function(a){console.log(t.asSelectable("getSelected").length),0===t.asSelectable("getSelected").length&&e.showed&&n.modal("show"),e.showed||n.modal("hide"),a.stopPropagation()}),s(a).on("click",'[data-action="trash"]',".site-action",function(){toastr.info("删除所选邮件")}),s(a).on("click",'[data-action="inbox"]',".site-action",function(){toastr.info("移动所选邮件到指定文件夹")}),s(a).on("asSelectable::change","[data-selectable]",function(a,t,i){i?(e.show(),n.modal("show")):e.hide()})},handleListItem:function(){s(a).on("click","#addLabelToggle",function(a){s("#addLabelForm").modal("show"),a.stopPropagation()}),s(a).on("click","[data-tag=list-delete]",function(t){i.top.layer.alert("您确定要删除这个标签吗？",{icon:4},function(a){s(t.target).closest(".list-group-item").remove(),i.top.layer.close(a)})})},itemTpl:function(a){return'<tr id="'+a.id+'" data-mailbox="slidePanel" '+("true"===a.unread?'class="unread"':"")+'><td class="cell-60"><span class="checkbox-custom checkbox-primary checkbox-lg"><input type="checkbox" class="mailbox-checkbox selectable-item" id="mail_'+a.id+'"/><label for="mail_'+a.id+'"></label></span></td><td class="cell-30 responsive-hide"><span class="checkbox-important checkbox-default"><input type="checkbox" class="mailbox-checkbox mailbox-important" '+("true"===a.starred?'checked="checked"':"")+' id="mail_'+a.id+'_important"/><label for="mail_'+a.id+'_important"></label></span></td><td class="cell-60 responsive-hide"><a class="avatar" href="javascript:;"><img class="img-responsive" src="'+a.avatar+'" alt="..."></a></td><td><div class="content"><div class="title">'+a.name+'</div><div class="abstract">'+a.title+'</div></div></td><td class="cell-30 responsive-hide">'+(0<a.attachments.length?'<i class="icon wb-paperclip" aria-hidden="true"></i>':"")+'</td><td class="cell-130"><div class="time">'+a.time+"</div>"+(0<a.group.length?'<div class="identity"><i class="wb-medium-point '+a.color+'" aria-hidden="true"></i>'+a.group+"</div>":"")+"</td></tr>"},attachmentsTpl:function(a){var i=this,e="";return e+='<div class="mail-attachments"><p><i Class="icon wb-paperclip"></i>Attachments | <a href="javascript:;">Download All</a></p><ul class="list-group">',s.each(a,function(a,t){e+=i.attachmentTpl(t)}),e+="</ul></div>"},attachmentTpl:function(a){return'<li class="list-group-item"><span class="name">'+a.name+'</span><span class="size">'+a.size+'</span><button type="button" class="btn btn-icon btn-pure btn-default"><i class="icon wb-download" aria-hidden="true"></i></button></li>'},messagesTpl:function(i){var e=this,n="";return s.each(i.messages,function(a,t){n+='<section class="slidePanel-inner-section"><div class="mail-header"><div class="mail-header-main"><a class="avatar" href="javascript:;"><img src="'+i.avatar+'" alt="..."></a><div><span class="name">'+i.name+'</span></div><div><a href="javascript:;" class="mailbox-panel-email">'+i.email+'</a> 发送给 <a href="javascript:;" class="mr-10">我</a><span class="identity"><i class="wb-medium-point red-600" aria-hidden="true"></i>'+i.group+'</span></div></div><div class="mail-header-right"><span class="time">'+t.time+'</span><div class="btn-group actions" role="group"><button type="button" class="btn btn-icon btn-pure btn-default"><i class="icon wb-star" aria-hidden="true"></i></button><button type="button" class="btn btn-icon btn-pure btn-default"><i class="icon wb-reply" aria-hidden="true"></i></button></div></div></div><div class="mail-content">'+t.content+"</div>",0===a&&t.attachments&&0<t.attachments.length&&(n+=e.attachmentsTpl(t.attachments)),n+="</section>"}),n},initMail:function(){var i=this;s.getJSON("../../../../public/data/examples/pages/mailbox.json",function(a){var t=s("#mailboxTable");i.buildMail(t,a),i.initMailData(a),i.handlSlidePanelPlugin()})},initMailData:function(a){this.mailboxData=a},buildMail:function(a,t){var i=this,e=s("<tbody></tbody>");s.each(t,function(a,t){i.buildItem(e,t)}),a.empty().append(e)},buildItem:function(a,t){a.append(s(this.itemTpl(t)).data("mailInfo",t))},handlSlidePanelPlugin:function(){var n=this;void 0!==s.slidePanel&&s(a).on("click",'[data-mailbox="slidePanel"]',function(a){s.slidePanel.show({url:"../../../../public/data/examples/pages/mailbox-panel.tpl",target:s(this)},s.concatCpt("slidePanel",{template:function(a){return'<div class="'+a.classes.base+" "+a.classes.base+"-"+a.direction+'"><div class="'+a.classes.base+'-scrollable"><div><div class="'+a.classes.content+'"></div></div></div><div class="'+a.classes.base+'-handler"></div></div>'},afterLoad:function(){this.$panel.find("."+this.options.classes.base+"-scrollable").mCustomScrollbar()},contentFilter:function(a,t){var i=s(t.target).data("mailInfo"),e=s(a);return s(".mailbox-panel-title",e).html(i.title),s(".slidePanel-messages",e).html(n.messagesTpl(i)),e}})),a.stopPropagation()})},run:function(){this.handleAction(),this.handleListItem(),this.initMail(),s("#addlabelForm").modal({show:!1}),s("#addMailForm").modal({show:!1}),s(a).on("click",".checkbox-important",function(a){a.stopPropagation()}),s(".markdown-edit").markdown({language:"zh",iconlibrary:"fa"})}}),s(function(){i.App.run()})}(document,window,jQuery);