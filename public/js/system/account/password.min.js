/**
 * Admui-iframe v2.1.0 (http://www.admui.com/)
 * Copyright 2015-2019 Admui Team
 * Licensed under the Admui License 1.1 (http://www.admui.com/about/license)
 */
!function(o,e,t){"use strict";var d=t.configs.ctx;t(function(){t.validator.addMethod("validPwd",function(e){var r=!1;return t.ajax({url:d+"/user/checkpassword",type:"POST",data:JSON.stringify({oldPassword:e}),dataType:"JSON",contentType:"application/json",async:!1,success:function(e){r=e.success},error:function(){toastr.error("服务器异常，请配合后端程序使用")}}),r},"请填写正确的密码"),t("#accountMsg").validate({rules:{oldPwd:{required:!0,validPwd:!0},newPwd:{required:!0,minlength:6,maxlength:30},confirm:{required:!0,equalTo:"#newPwd"}},messages:{oldPwd:{required:"密码不能为空"},newPwd:{required:"密码不能为空",minlength:"密码必须大于等于6个字符",maxlength:"密码必须小于等于30个字符"},confirm:{required:"确认密码不能为空",equalTo:"确认密码必须和密码保持一致"}},submitHandler:function(e){var r=t(e).find('[name="oldPwd"]').val(),n=t(e).find('[name="newPwd"]').val(),a=t(e).find('[name="confirm"]').val();t.ajax({url:d+"/user/changepassword",type:"POST",data:JSON.stringify({oldPassword:r,newPassword:n,repPassword:a}),dataType:"JSON",contentType:"application/json",success:function(e){var r,n=5;e.success?(o.top.layer.alert('<p id="modifyPwd"><span>'+n+"</span>秒后将自动跳转到登录页面</p>"),r=setInterval(function(){n-=1,t("#modifyPwd span").text(n),0===n&&(clearTimeout(r),o.parent.location.href="/logout")},1e3)):toastr.error(e.msg)},error:function(){toastr.error("服务器异常，请稍后再试！")}})}})})}(window,document,jQuery);